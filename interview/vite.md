1. 热更新原理：创建ws连接、监听文件变化、告知客户端变化文件、重新请求或删除文件。
2. 插件。各个时期执行的函数的一个对象。hooks分为异步同步、窜行并行。基于rollup的插件系统。
3. 依赖预构建。根据用户pakage.json、lock文件生成dephash，获取上次的预构建信息进行对比。一样则不构建不一样则重新构建。esbuild扫描文件获取依赖。转化为es module模式、构建完之后存入cachedir。请求资源时判断请求路径是否为缓存路径，是则更改路径、遇到新的依赖则重新构建。
4. server流程。参数解析、创建http服务、创建文件监听。
5. 为什么仍然需要打包
    1. 不打包的话增加http请求，效率低下。打包可以进行tree shaking，懒加载，模块合并，优化请求往返和打包体积。
    2. esbuild在构建方面还不够完善，特别是特别是代码分割和 CSS 处理方面。

6. > vite
    >
    > config解析流程。获取cli参数、加载配置文件、加载env文件、对plugin进行排序。执行plugin里有关config的hook函数。解析cache dir、根目录和绝对资源目录。添加内置插件。创建一个内部使用的插件调用对象。汇集所有的参数成一个参数对象。
    >
    > 依赖预构建。作用：将各种模块模式统一处理为es module的形式。流程成。启动server前获取cache目录下的_metadata.json文件获取上次预处理依赖。通过json文件生成dephash，通过比对判断是否有新的依赖，如果有，对文件递归扫描获取依赖，通过esbuild进行esmodule 的转化。然后更新cachedir里的文件。在开发过程中遇到新的依赖时，重新开启整个流程。
    >
    > 插件。基于rollup的插件接口设计实现的，所以一定程度上rollup的接口同样适用于vite，同时vite也加了属于自己的特有钩子函数。作用，是vite的开箱即用能够实现的核心。
    >
    > 热更新。流程，客户端服务器通过websocket进行链接。服务器监听文件变更。通知客户端本次更新的类型和文件路径。客户端根据文件路径创建新的link或者script标签拉去新的文件。并执行相应的热更新 钩子函数。
    >
    > 为什么还需要打包构建。不打包的话 每个文件都会进行http请求。

